source('~/Documents/workspace/machinelearningscripts/titanic/neural_net_analysis.R')
source('~/Documents/workspace/machinelearningscripts/titanic/ml_lib.R')
source('~/Documents/workspace/machinelearningscripts/titanic/neural_net_analysis.R')
setwd("./Documents/workspace/machinelearningscripts/titanic/")
source('~/Documents/workspace/machinelearningscripts/titanic/neural_net_analysis.R')
View(nn$result.matrix)
writePredictionFile(nn, test, "Survived", c("PassengerId", "Survived", "Name"), fileName="prediction_nn_h52_feat_eng.csv")
writePredictionFile(nn, test, "PassengerId", "Survived", c("PassengerId", "Survived", "Name"), fileName="prediction_nn_h52_feat_eng.csv")
save.image("~/Documents/workspace/machinelearningscripts/titanic/neural_net_model_079904.RData")
clusters <- kmeans(allData[,!names(allData) %in% c("PassengerId", "Survived", "Name")], 3)
clusters <- kmeans(allData[,!names(allData) %in% c("PassengerId", "Survived", "Name")], 3)
str(clusters)
str(allData[,!names(allData) %in% c("PassengerId", "Survived", "Name")])
scaled_alldata <- normalizeDataForNN(allData[,!names(allData) %in% c("PassengerId", "Survived", "Name")])
View(scaled_alldata)
clusters <- kmeans(scaled_alldata[,!names(scaled_alldata) %in% c("PassengerId", "Survived", "Name")], 3)
str(clusters)
allData$clusters <- clusters$cluster
View(allData)
table(allData$Pclass, allData$clusters)
table(allData[allData$PassengerId %in% train$PassengerId, "Survived"], allData[allData$PassengerId %in% train$PassengerId, "clusters"])
table(allData[allData$PassengerId %in% train$PassengerId, c("Survived")], allData[allData$PassengerId %in% train$PassengerId, c("clusters")])
max(test$PassengerId)
max(train$PassengerId)
table(allData[allData$PassengerId < 892, c("Survived")], allData[allData$PassengerId < 892, c("clusters")])
str(allData)
table(allData[[allData$PassengerId < 892, c("Survived")]], allData[[allData$PassengerId < 892, c("clusters")]])
table(allData$PassengerId, allData$clusters)
table(allData$Survived, allData$clusters)
clusters <- kmeans(allData[,!names(allData) %in% c("PassengerId", "Survived", "Name")], 2)
clusters <- kmeans(scaled_alldata[,!names(scaled_alldata) %in% c("PassengerId", "Survived", "Name")], 2)
allData$clusters <- clusters$cluster
table(allData$Survived, allData$clusters)
a <- allData$PassengerId < 892
a <- allData[allData$PassengerId < 892,]
table(a$Survived, a$clusters)
clusters <- kmeans(scaled_alldata[,!names(scaled_alldata) %in% c("PassengerId", "Survived", "Name")], 3)
allData$clusters <- clusters$cluster
train <- allData[allData$PassengerId %in% train$PassengerId,]
test <- allData[allData$PassengerId %in% test$PassengerId,]
scaled_train <- normalizeDataForNN(train)
nn2 <- trainNN(scaled_train, "Survived", c("PassengerId", "Survived", "Name"), hidden=c(5,2), algorithm="sag", threshold=0.01, stepmax=20e6, linear.output=F)
head(train)
nn2 <- trainNN(scaled_train, "Survived", c("PassengerId", "Survived", "Name"), hidden=c(5,2), algorithm="slr", threshold=0.01, stepmax=20e6, linear.output=F)
nn2 <- trainNN(scaled_train, "Survived", c("PassengerId", "Survived", "Name"), hidden=c(5,2), algorithm="sag", threshold=0.01, stepmax=20e6, linear.output=F)
View(nn2$result.matrix)
writePredictionFile(nn2, test, "PassengerId", "Survived", c("PassengerId", "Survived", "Name"), fileName="prediction_nn_h52_feat_eng2.csv")
nn2 <- trainNN(scaled_train, "Survived", c("PassengerId", "Survived", "Name"), hidden=c(5,2), algorithm="sag", threshold=0.01, stepmax=20e6, linear.output=F)
View(nn2$result.matrix)
writePredictionFile(nn2, test, "PassengerId", "Survived", c("PassengerId", "Survived", "Name"), fileName="prediction_nn_h52_feat_eng2.csv")
save.image("~/Documents/workspace/machinelearningscripts/titanic/neural_net_model_081340.RData")
load("~/Documents/workspace/machinelearningscripts/titanic/neural_net_model_081340.RData")
View(allData)
a <- sapply(allData$Cabin, function(x) substring(x,1,1))
head(a)
allData$CabinClass <- sapply(allData$Cabin, function(x) substring(x,1,1))
train <- allData[allData$PassengerId %in% train$PassengerId,]
test <- allData[allData$PassengerId %in% test$PassengerId,]
scaled_train <- normalizeDataForNN(train)
allData$CabinClass <- as.factor(sapply(allData$Cabin, function(x) substring(x,1,1)))
train <- allData[allData$PassengerId %in% train$PassengerId,]
test <- allData[allData$PassengerId %in% test$PassengerId,]
scaled_train <- normalizeDataForNN(train)
nn3 <- trainNN(scaled_train, "Survived", c("PassengerId", "Survived", "Name"), hidden=c(5,2), algorithm="sag", threshold=0.01, stepmax=20e6, linear.output=F)
View(nn3$result.matrix)
writePredictionFile(nn3, test, "PassengerId", "Survived", c("PassengerId", "Survived", "Name"), fileName="prediction_nn_h52_feat_eng3.csv")
?rpart
library("rpart", lib.loc="/usr/local/Cellar/r/3.3.0/R.framework/Versions/3.3/Resources/library")
?rpart
f <- as.formula(paste("Survived", " ~ ", paste(names(train)[!names(train) %in% c("PassengerId", "Survived", "Name")], collapse = " + ")))
a <- rpart(f, train, method="class")
str(a)
View(a$variable.importance)
View(a$splits)
nn3 <- trainNN(scaled_train, "Survived", c("PassengerId", "Survived", "Name", "Ticket", "Embarked"), hidden=c(5,2), algorithm="sag", threshold=0.01, stepmax=20e6, linear.output=F)
nn3 <- trainNN(scaled_train, "Survived", c("PassengerId", "Survived", "Name", "Ticket", "Embarked"), hidden=c(5,2), algorithm="sag", threshold=0.01, stepmax=20e6, linear.output=F)
nn3 <- trainNN(scaled_train, "Survived", c("PassengerId", "Survived", "Name", "Ticket", "Embarked"), hidden=c(5,2), algorithm="sag", threshold=0.01, stepmax=20e6, linear.output=F)
View(nn3$result.matrix)
writePredictionFile(nn3, test, "PassengerId", "Survived", c("PassengerId", "Survived", "Name"), fileName="prediction_nn_h52_feat_eng3.csv")
writePredictionFile(nn3, test, "PassengerId", "Survived", c("PassengerId", "Survived", "Name", "Ticket", "Embarked"), fileName="prediction_nn_h52_feat_eng3.csv")
nn3 <- trainNN(scaled_train, "Survived", c("PassengerId", "Survived", "Name", "Ticket", "Embarked"), hidden=c(5,3), algorithm="sag", threshold=0.01, stepmax=2000e6, linear.output=F)
View(nn3$result.matrix)
writePredictionFile(nn3, test, "PassengerId", "Survived", c("PassengerId", "Survived", "Name", "Ticket", "Embarked"), fileName="prediction_nn_h52_feat_eng3.csv")
nn3 <- trainNN(scaled_train, "Survived", c("PassengerId", "Survived", "Name", "Ticket", "Embarked"), hidden=c(5,3), algorithm="sag", threshold=0.01, stepmax=2000e6, linear.output=F)
